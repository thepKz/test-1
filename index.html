<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Unica+One&amp;display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script defer src="main.js"></script>
    <title>Viện Bảo Tàng Lịch Sử Kháng Chiến</title>
</head>
<body>
    <iframe id="backgroundIframe" src="iframe/iframe3/index.html" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; border: none; z-index: 0;"></iframe>
    <div id="portalCard">
        <div class="gooey-effect">
            <div class="gooey-blob"></div>
            <div class="gooey-blob"></div>
            <div class="gooey-blob"></div>
            <div class="gooey-blob"></div>
        </div>
        <div id="portalContent">
            <h1>VIỆN BẢO TÀNG<br>LỊCH SỬ</h1>
            <p class="subtitle">Kháng chiến chống Pháp 1858-1930</p>
            <button id="portalButton">THAM QUAN</button>
        </div>
        <canvas class="card-bg" id="cardBgEffect"></canvas>
    </div>
    
    <div id="tunnelContainer">
        <canvas id="tunnelCanvas"></canvas>
        <div id="skipButton" style="display: none;">
            <button id="skipBtn">SKIP →</button>
        </div>
    </div>

    <div id="iframeContainer" style="display: none; width: 100vw; height: 100vh; position: absolute; top: 0; left: 0; z-index: 20; background: #000; opacity: 0; transition: opacity 1s; overflow-y: scroll; overflow-x: hidden;">
        <style>
            /* Custom dark scrollbar */
            #iframeContainer::-webkit-scrollbar {
                width: 10px;
            }
            #iframeContainer::-webkit-scrollbar-track {
                background: #111;
            }
            #iframeContainer::-webkit-scrollbar-thumb {
                background: #444;
                border-radius: 5px;
            }
            #iframeContainer::-webkit-scrollbar-thumb:hover {
                background: #666;
            }
        </style>
        <script>
            // Sync scroll từ iframeContainer vào iframe4 để scroll magic hoạt động
            (function() {
                function setupScrollSync() {
                    const iframeContainer = document.getElementById('iframeContainer');
                    const iframe4 = document.getElementById('iframe4Background');
                    
                    if (iframeContainer && iframe4) {
                        function syncScroll() {
                            const scrollTop = iframeContainer.scrollTop;
                            try {
                                iframe4.contentWindow.postMessage({
                                    type: 'scroll',
                                    scrollY: scrollTop
                                }, '*');
                            } catch(e) {
                                console.error('Error sending scroll message:', e);
                            }
                        }
                        
                        // Đợi iframe4 load xong
                        iframe4.onload = function() {
                            iframeContainer.addEventListener('scroll', syncScroll);
                            // Sync ngay lần đầu
                            syncScroll();
                        };
                        
                        // Nếu iframe đã load rồi
                        if (iframe4.contentWindow && iframe4.contentWindow.document.readyState === 'complete') {
                            iframeContainer.addEventListener('scroll', syncScroll);
                            syncScroll();
                        }
                    }
                }
                
                // Chạy khi DOM ready
                if (document.readyState === 'loading') {
                    document.addEventListener('DOMContentLoaded', setupScrollSync);
                } else {
                    setupScrollSync();
                }
            })();
        </script>
    </div>
</body>
</html>